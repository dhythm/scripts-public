# 要件ドキュメント

## はじめに

この機能は、指定されたディレクトリ内の PDF ファイルをスキャンし、Google Cloud Vision API または Google Cloud Document AI を使用してテキストを抽出する TypeScript プログラムを作成します。プログラムはディレクトリ内の各 PDF ファイルを処理し、クラウドベースの OCR サービスを使用してテキストコンテンツを抽出し、抽出されたテキストを出力ファイルに保存します。

## 要件

### 要件 1

**ユーザーストーリー:** 開発者として、指定したディレクトリ内の PDF ファイルから Google Cloud サービスを使用してテキストを抽出したい。それにより、テキストコンテンツを効率的に処理・分析できるようにしたい。

#### 受け入れ基準

1. プログラムがディレクトリパスで実行される時、システムはディレクトリ内の PDF ファイルをスキャンすること
2. プログラムが PDF ファイルを見つけた時、システムは各ファイルを順次処理すること
3. PDF ファイルを処理する時、システムは Google Cloud Vision API または Document AI を使用してテキストを抽出すること
4. テキスト抽出が完了した時、システムは抽出されたテキストを同じ名前で.txt 拡張子のファイルに保存すること
5. 処理中にエラーが発生した時、システムはエラーをログに記録し、次のファイルの処理を続行すること
6. プログラムがすべてのファイルの処理を完了した時、システムは処理されたファイルの概要を提供すること

### 要件 2

**ユーザーストーリー:** 開発者として、PDF テキスト抽出プロセスの設定オプションが欲しい。それにより、ニーズに基づいて動作をカスタマイズできるようにしたい。

#### 受け入れ基準

1. プログラム起動時、システムはディレクトリパスのコマンドライン引数を受け付けること
2. プログラム起動時、システムは Google Cloud Vision API と Document AI を選択するためのオプション引数を受け付けること
3. プログラム起動時、システムは出力ディレクトリのオプション引数を受け付けること
4. プログラム起動時、システムはファイルパターンマッチングのオプション引数を受け付けること
5. 出力ディレクトリが指定されていない場合、システムは入力ファイルと同じディレクトリを使用すること

### 要件 3

**ユーザーストーリー:** 開発者として、クラウドサービスの適切な認証とエラー処理が欲しい。それにより、プログラムが異なる環境で確実に実行されるようにしたい。

#### 受け入れ基準

1. プログラム起動時、システムは Google Cloud 認証情報を確認すること
2. 認証情報が不足しているか無効な場合、システムは明確なエラーメッセージを提供すること
3. PDF ファイルを処理できない場合、システムは具体的なエラー情報をログに記録すること
4. ネットワークエラーが発生した場合、システムは適切なバックオフを伴うリトライロジックを実装すること
5. レート制限に遭遇した場合、システムはそれを適切に処理すること

### 要件 4

**ユーザーストーリー:** 開発者として、複数のファイルを処理するためのパフォーマンス最適化が欲しい。それにより、抽出プロセスが妥当な時間内に完了するようにしたい。

#### 受け入れ基準

1. 複数の PDF ファイルを処理する時、システムは適切な場合に並行処理を使用すること
2. 大きな PDF ファイルを処理する時、システムは進行状況インジケータを表示すること
3. テキストを抽出する時、システムはコストを最小限に抑えるために API 呼び出しを最適化すること
4. 処理が完了した時、システムはパフォーマンスメトリクス（所要時間、処理されたファイル）を提供すること
